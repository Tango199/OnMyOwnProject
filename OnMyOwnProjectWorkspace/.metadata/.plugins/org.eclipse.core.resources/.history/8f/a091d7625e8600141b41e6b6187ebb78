package OnMyOwnProjectSchoolSelectionProgram;

import java.io.*;
import java.util.*;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;

import Core.ProblemInfo;

public class OnMyOwnProjectSchoolSelectionProgram 
{
	
	public OnMyOwnProjectSchoolSelectionProgram() throws IOException
	{
		
		ProblemInfo.inputPath = ProblemInfo.workingDirectory + "\\data\\input\\";
		System.out.println(ProblemInfo.inputPath);
		try {
			FileInputStream file = new FileInputStream(new File(ProblemInfo.inputPath + "Schools.xls"));
			HSSFWorkbook schoolWorkbook = new HSSFWorkbook(file);
			HSSFSheet schoolSheet = schoolWorkbook.getSheetAt(0);
			Cell cell = null;
			ProblemInfo.numSchools = schoolSheet.getPhysicalNumberOfRows() -1;
			System.out.println(ProblemInfo.numSchools);
			int rowCountSchools = 1;
			int colCounter = 0;
			String schoolName;
			String tempString;
			int numStudentsPerSchool;
			List<School> schools = new ArrayList<School>();
			int arrayCounter=0;
			for(int numSchools = ProblemInfo.numSchools;numSchools>0;numSchools--)
			{
				cell = schoolSheet.getRow(rowCountSchools).getCell(colCounter++);
				schoolName = cell.toString();
				cell = schoolSheet.getRow(rowCountSchools).getCell(colCounter);
				tempString = cell.toString();
				tempString = tempString.substring(0,tempString.length()-2);
				numStudentsPerSchool = Integer.parseInt(tempString);
				
				ProblemInfo.print(schoolName);
				ProblemInfo.print(numStudentsPerSchool);
				rowCountSchools++;
				colCounter=0;
				schools.add(new School(schoolName,numStudentsPerSchool));
				
				
			}
			ProblemInfo.print(schools.get(0).getSchoolName());
			ProblemInfo.print(schools.get(3).getSchoolName());
			
		} catch (FileNotFoundException e) {
			
			e.printStackTrace();
		}
	}
}
